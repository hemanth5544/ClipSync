# Railway Configuration for Desktop Next.js Web App
# IMPORTANT: This deploys ONLY the Next.js web app (NOT Electron)
# In Railway Dashboard:
# 1. Settings → Source → Root Directory: Leave EMPTY (use repo root)
# 2. Settings → Build → Builder: Use "Nixpacks" or "Railpack" (Default)

[build]
builder = "NIXPACKS"
# Install root dependencies, then desktop dependencies, generate Prisma, build Next.js
buildCommand = "pnpm install && cd apps/desktop && pnpm install && pnpm prisma:generate"

[deploy]
# Next.js standalone output: server.js is in .next/standalone
# Run from desktop directory so paths resolve correctly
startCommand = "pnpm run desktop:dev"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
